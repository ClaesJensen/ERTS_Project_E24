#ifndef CONTROL_H
#define CONTROL_H
#include "lpmk3.hpp"
#include "uart.hpp"
#include "biquadCoefficients.hpp"

#define MAX_ROW 8
#define MAX_COL 8
#define ACTIVE_BUTTONS MAX_ROW * MAX_COL

class Control {
public:
    Control(LPMK3 *device, UART *uart, BiquadCoefficients *biquad, double Q[MAX_COL], double f0[MAX_COL], double dbGain[MAX_COL]);
    void Input(uint8_t btn, bool isPressed);
private:
    void LEDFader(uint8_t col, uint8_t btn, uint8_t r, uint8_t g, uint8_t b);
    void PopulateFilterMessages();
    LPMK3 *device;
    UART *uart;
    BiquadCoefficients *biquad;
    double *Q; 
    double *f0; 
    double *dbGain;

    uint8_t filterMsg[ACTIVE_BUTTONS][23];


    uint8_t PeakingEQMsgPos30[23] = {
        'F', 'S', 0x00, 
        0x01, 0x16, 0xAD, 0xF4,
        0xFE, 0x05, 0xD9, 0x4C,
        0x00, 0xE7, 0xD6, 0xD8,
        0xFE, 0x05, 0xD9, 0x4C,
        0x00, 0xFE, 0x84, 0xCE
    };

    uint8_t PeakingEQMsgPos20[23] = {
        'F', 'S', 0x00, 
        0x01, 0x0B, 0xD3, 0x93,
        0xFE, 0x06, 0xFC, 0x63,
        0x00, 0xF1, 0x8B, 0xA0,
        0xFE, 0x06, 0xFC, 0x63, 
        0x00, 0xFD, 0x5F, 0x34
    };


    uint8_t PeakingEQMsgPos10[23] = {
        'F', 'S', 0x00, 
        0x01, 0x05, 0x08, 0x58,
        0xFE, 0x08, 0xFE, 0xCF,
        0x00, 0xF6, 0x4F, 0xFE,
        0xFE, 0x08, 0xFE, 0xCF,
        0x00, 0xFB, 0x58, 0x57
    };


    uint8_t Passthrough[23] = {
        'F', 'S', 0x00, 
        0x00, 0x80, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00
    };


    
    uint8_t TEST[23] = {
        'F', 'S', 0x00, 
        0x00, 0xEA, 0x72, 0xE9,
        0xFE, 0x33, 0xDC, 0xa7,
        0x00, 0xE5, 0xA8, 0xE4,
        0xFE, 0x33, 0xDC, 0xA7,
        0x00, 0xD0, 0x1B, 0xCE
    };

    uint8_t PeakingEQMsgNeg10[23] = {
        'F', 'S', 0x00, 
        0x00, 0xFB, 0x10, 0x7D, 
        0xFE, 0x12, 0xB1, 0x6D,
        0x00, 0xF6, 0x7F, 0xCF,
        0xFE, 0x12, 0xB1, 0x6D,
        0x00, 0xF1, 0x90, 0x4D
    };
    uint8_t PeakingEQMsgNeg20[23] = {
        'F', 'S', 0x00, 
        0x00, 0xF4, 0xB2, 0x1C,
        0xFE, 0x1D, 0x49, 0x31,
        0x00, 0xF2, 0x2F, 0x06,
        0xFE, 0x1D, 0x49, 0x31,
        0x00, 0xE6, 0xE1, 0x23
    };
    uint8_t PeakingEQMsgNeg30[23] = {
        'F', 'S', 0x00, 
        0x00, 0xEB, 0x2A, 0x8A,
        0xFE, 0x2F, 0x0A, 0x5B,
        0x00, 0xE9, 0xCE, 0x35,
        0xFE, 0x2F, 0x0A, 0x5B,
        0x00, 0xD4, 0xF8, 0xC0
    };
    uint8_t PeakingEQMsgNeg40[23] = {
        'F', 'S', 0x00, 
        0x00, 0xDC, 0x73, 0x1A,
        0xFE, 0x4B, 0x95, 0xB4,
        0x00, 0xDB, 0xBB, 0x3E,
        0xFE, 0x4B, 0x95, 0xB4,
        0x00, 0xB8, 0x2E, 0x59
    };

};
#endif